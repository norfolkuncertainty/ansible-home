global
    maxconn     20000
    log         127.0.0.1 local0
    user        haproxy
    chroot      /usr/share/haproxy
    pidfile     /run/haproxy.pid
    daemon

defaults
  mode tcp
  timeout client 10s
  timeout connect 5s
  timeout server 10s 
  timeout http-request 10s

{% for frontend in haproxy_front_ends %}
frontend {{ frontend.name }}
  bind {{ frontend.bind}}
  default_backend {{ frontend.default_backend }}

{% endfor %}

{% for backend in haproxy_back_ends %}
backend {{ backend.name }}
  server {{ backend.server }}
  
{% endfor %}